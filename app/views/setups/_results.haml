.results#setups-results
  %header
    %h2#setups-results-title{tabindex: -1}<
      Results
      %span.sr-only ,
      %span.badge= @setups.total_count

  = search_form_for(@q, url: {controller: :setups, action: :results},  html: {multipart: true, class: 'form-vertical', remote: true}, format: 'js', wrapper: :vertical_form, wrapper_mappings: { check_boxes: :vertical_radio_and_checkboxes, radio_buttons: :vertical_radio_and_checkboxes}) do |f|

    %table.index-table.table-responsive
      %caption.sr-only Results table for setups
      %thead
        %tr
          -#-if admin?
            -#%th{scope: "col"}<
              -#= sort_link @q, :id, 'ID'
          %th{scope: "col"}<
            = sort_link @q, :platform_name, 'Platform'
          %th{scope: "col"}<
            = sort_link @q, :assistive_technology_name, 'Assistive Technology'
          %th{scope: "col"}<
            = sort_link @q, :browser_reader_name, 'Read with'
          %th{scope: "col"}<
            = sort_link @q, :file_format_name, 'File Format'
          %th{scope: "col"}<
            = sort_link @q, :renderer_name, 'Renderer'
          %th{scope: "col"}<
            = sort_link @q, :outputs_count, 'Outputs' #TODO improve perf
          %th{scope: "col"}<
            = sort_link @q, :status_name, 'Status'
          %th{scope: "col"}<
            Action
        %tr
          -#-if admin?
            -#%th<
          %th<
            = f.input  :platform_version_platform_id_eq, collection: @platforms, as: :select, include_blank: "Any platform", label: false, required: false
          %th<
            = f.input  :assistive_technology_version_assistive_technology_id_eq, collection: @assistive_technologies, as: :select, include_blank: "Any assistive technology", label: false, required: false
          %th<
            = f.input  :browser_reader_version_browser_reader_id_eq, collection: @browser_readers, as: :select, include_blank: "Any reader", label: false, required: false
          %th<
            = f.input  :file_format_id_eq, collection: @file_formats, as: :select, include_blank: "Any file format", label: false, required: false
          %th<
            = f.input  :renderer_id_eq, collection: @renderers, as: :select, include_blank: "Any renderer", label: false, required: false
          %th<
            = f.input  :outputs_id_eq, collection: @outputs, as: :select, include_blank: "Any outputs", label: false, required: false
          %th<
            = f.input  :workflow_status_id_eq, collection: @workflow_status, as: :select, include_blank: "Any status", label: false, required: false
          %th<
            .btn-group
              = link_to results_setups_path(search_cancel: true), class: 'btn btn-danger btn-sm' do
                %span.sr-only Clear
                %i.fa.fa-fw.fa-close
              = button_tag type: "submit", class: "btn btn-success btn-sm" do
                %span.sr-only Search
                %i.fa.fa-fw.fa-search

      %tbody
        - @setups.each_with_index do |setup, idx|
          %tr{class: "item"}
            -#-if admin?
              -#%td= setup.id
            %td= setup.platform_version
            %td= setup.assistive_technology_version
            %td= setup.browser_reader_version
            %td= setup.file_format
            %td= setup.renderer
            %td
              -setup.outputs.uniq.each do |a|
                #{a}
                %br
            %td= setup.workflow_status
            %td
              =link_to setup_path(setup) do
                Learn more
