.panel.panel-default#simple-search
  %h2.panel-heading
    Search for a setup
  = search_form_for(@q, url: {controller: "setups", action: "results"}, html: {multipart: true, class: 'form-vertical'}, wrapper: :vertical_form, wrapper_mappings: { check_boxes: :vertical_radio_and_checkboxes, radio_buttons: :vertical_radio_and_checkboxes}) do |f|

    .panel-body
      .form-inputs
        = f.input  :platform_version_platform_id_eq, as: :select, include_blank: "Any platform", label: false, required: false,
          collection: @platforms.map{|e| [e.title, e.id, {data: {mappings: {assistive_technology_version_assistive_technology_id_eq: e.assistive_technologies.map{|a| a.version_ids}.flatten, browser_reader_version_browser_reader_id_eq: e.browser_readers.map{|a| a.version_ids}.flatten }}}]}
        = f.input  :assistive_technology_version_assistive_technology_id_eq, as: :select, include_blank: "Any assistive technology", label: false, required: false,
          collection: @assistive_technologies.map{|e| [e.title, e.id, {data: {mappings: {browser_reader_version_browser_reader_id_eq: e.browser_readers.map{|a| a.version_ids}.flatten, platform_version_platform_id_eq: e.platforms.map{|a| a.version_ids}.flatten }}}]}
        = f.input  :browser_reader_version_browser_reader_id_eq, as: :select, include_blank: "Any reader", label: false, required: false,
          collection: @browser_readers.map{|e| [e.title, e.id, {data: {mappings: {assistive_technology_version_assistive_technology_id_eq: e.assistive_technologies.map{|a| a.version_ids}.flatten, file_format_id_eq: e.file_formats.map{|a| a.id}.flatten, renderer_id_eq: e.renderers.map{|a| a.id}.flatten, platform_version_platform_id_eq: e.platforms.map{|a| a.version_ids}.flatten }}}]}
        = f.input  :file_format_id_eq, as: :select, include_blank: "Any file format", label: false, required: false,
          collection: @file_formats.map{|e| [e.title, e.id, {data: {mappings: {browser_reader_version_browser_reader_id_eq: e.browser_readers.map{|a| a.version_ids}.flatten}}}]}


    .panel-footer
      = f.button :submit, class: 'btn btn-success'
      = link_to results_setups_path, class: "btn btn-primary" do
        browse all
